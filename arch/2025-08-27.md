# boot 分区扩容

boot分区原先设置了500M，最近升级系统时报100%满了，因为我的boot目录下同时有initramfs-linux.img 和 initramfs-linux-zen.img 所以占用多一些

今天决定扩容到1G， 以下为扩容以后的效果和详细步骤（务必先备份重要数据）
```
$ sudo fdisk -l /dev/sda
Disk /dev/sda: 232.89 GiB, 250059350016 bytes, 488397168 sectors
Disk model: Samsung SSD 870
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0xe6e48180

Device     Boot   Start       End   Sectors   Size Id Type
/dev/sda1  *       2048   2047999   2045952   999M  c W95 FAT32 (LBA)
/dev/sda2       2048000 488397167 486349168 231.9G 83 Linux
```

## 步骤 1：从 live 环境启动

检查 Arch Linux 系统是否使用 EFI 启动
```
 ls /sys/firmware/efi
```
如果命令输出了文件或目录（如 efivars），说明是 EFI 启动；若提示 "No such file or directory" 则为 BIOS 启动。经过测试我的系统是EFI启动，开始没检查使用 BIOS 启动Live-CD，修复完的系统出现了奇怪的问题。
 
使用 Arch Linux live USB/CD 启动电脑，如果原系统是 EFI 启动；同时U盘引导时如果有2个u盘项也要选择带UEFI标示的，不然安装grub时会报错 **EFI variables are not supported on this system**

## 步骤 2：备份原系统

## 步骤 3：确认磁盘和分区信息
```
lsblk  # 列出所有磁盘和分区（如/dev/sda、/dev/nvme0n1）
fdisk -l /dev/sdX  # 替换sdX为目标磁盘（如/dev/sda），查看分区表详情
```

通过 fdisk 输出的 "Disk label type" 判断磁盘类型MBR而非GPT，所以我用fdisk调整分区（如果是GPT可以使用gdisk调整分区表）

## 步骤 4：调整文件系统大小（此操作需要boot分区后面有未分配的磁盘空间，因为我的不满足，未使用此步骤）
根据 boot 分区的文件系统类型操作：
### 情况 1：文件系统为 ext4
1. 检查文件系统错误：
```
e2fsck -f /dev/sdX1  # 替换为boot分区路径，-f强制检查
```
2. 扩容文件系统（自动匹配分区大小）：
```
resize2fs /dev/sdX1
```
### 情况 2：文件系统为 vfat（EFI 系统分区）
1. 检查文件系统错误：
```
dosfsck -f /dev/sdX1  # -f强制检查
```
2. 扩容文件系统（需先安装dosfstools）：
```
pacman -Sy dosfstools  # 在live环境安装工具
resize.vfat /dev/sdX1  # 自动扩容到分区大小
```
